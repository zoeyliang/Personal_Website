<!DOCTYPE HTML>
<!-- Main Page -->
<html>
<head>
    <title>JiaxingLiang</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <!-- 图标字体 & 音乐状态初始化 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script>
        // 音乐状态加载器
        window.audioState = JSON.parse(localStorage.getItem('audioState')) || {
            playing: true,
            volume: 0.5,
            progress: 0
        };
    </script>
</head>

<style>
    /* 原有样式 */
    body {
        font-family: Courier;
        background-image: url("images/home_backgrd.jpg");
        background-size: cover;
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-position: center;
        width: 100%;
        image-rendering: -webkit-optimize-contrast;
    }
    
    #footer {
        position: absolute;
        bottom: 0;
        height: 10px;
        width: 100%;
        background: transparent;
    }

    /* 新增音乐控件样式 */
    #music-ctl {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 9999;
        color: #999;
        cursor: pointer;
        font-family: Courier;
        background: rgba(0,0,0,0.3);
        padding: 8px 15px;
        border-radius: 20px;
        transition: all 0.3s;
    }
    #music-ctl:hover { color: #666; }
    #music-status {
        font-size: 0.8em;
        margin-left: 8px;
        vertical-align: middle;
    }
</style>

<body class="homepage is-preload">
    <!-- 全局音乐控制器 -->
    <div id="music-ctl" title="Background Music">
        <i class="fas fa-music"></i>
        <span id="music-status">[loading]</span>
    </div>
    <audio id="global-audio" loop>
        <source src="/audio/bgm.mp3" type="audio/mpeg">
        <source src="/audio/bgm.ogg" type="audio/ogg">
    </audio>

    <div id="page-wrapper">
        <section id="header" class="wrapper">
            <!-- Header -->
            <nav id="logo" class="navbar navbar-default">
                <h1 style="color:white;font-size:35px;">JIAXING LIANG</h1>
                <br>
                <p style="color:white;font-size:20px;font-style:bold">Hi, Welcome to my space (.<_<)</p>
            </nav>

            <nav id="nav">
                <ul>
                    <li class="current"><a href="index.html">Home</a></li>
                    <li><a href="Background.html">Background</a></li>
                    <li><a href="ResearchInterest.html">Research Interest</a></li>
                    <li><a href="Teaching.html">Teaching</a></li>
                    <li><a href="Publication.html">Publication</a></li>
                    <li><a href="Contact.html">Contact</a></li>
                    <li><a href="Library.html">^_*</a></li>
                </ul>
            </nav>

            <!-- Footer -->
            <div id="footer">
                <div class="container">
                    <div id="copyright">
                        <ul>
                            <li>Last updated: Jan 22, 2025</li>
                            <li>Background pics: from NASA Website</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- 音乐控制脚本 -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const audio = document.getElementById('global-audio');
            const ctl = document.getElementById('music-ctl');
            const status = document.getElementById('music-status');

            // 加载存储状态
            audio.volume = audioState.volume;
            audio.currentTime = audioState.progress;

            // 自动播放处理
            const playAudio = () => {
                audio.play()
                    .then(() => {
                        audio.muted = false;
                        status.textContent = '[playing]';
                        ctl.style.color = '#666';
                    })
                    .catch(() => {
                        status.textContent = '[click to start]';
                        ctl.onclick = () => {
                            audio.play();
                            ctl.onclick = toggleMute;
                        };
                    });
            };

            // 静音切换
            const toggleMute = () => {
                audio.muted = !audio.muted;
                status.textContent = audio.muted ? '[muted]' : '[playing]';
                ctl.style.color = audio.muted ? '#999' : '#666';
                localStorage.setItem('audioState', JSON.stringify({
                    playing: !audio.muted,
                    volume: audio.volume,
                    progress: audio.currentTime
                }));
            };

            // 保存播放进度
            setInterval(() => {
                localStorage.setItem('audioState', JSON.stringify({
                    playing: !audio.muted,
                    volume: audio.volume,
                    progress: audio.currentTime
                }));
            }, 1000);

            // 初始化音乐
            audio.muted = !audioState.playing;
            ctl.onclick = toggleMute;
            playAudio();
        });
    </script>

    <!-- 原有脚本 -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.dropotron.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>
</body>
</html>
